---
/**
 * PropertyList - Displays a grid of property items with icons
 * Used for general property lists outside of crystal system cards
 */
import Card from '../ui-astro/Card.astro';
import Badge from '../ui-astro/Badge.astro';
import { getIconForProperty, iconPaths } from './icons';

interface Item {
  name: string;
  value?: string;
  description?: string;
  examples?: string[];
  icon?: string;
}

interface Props {
  items: Item[];
  variant?: 'default' | 'compact';
}

const { items, variant = 'default' } = Astro.props;

// Detect if value looks like CDL notation
const isCDL = (value: string) => /^\w+\[\w+\]:\{/.test(value);

// Icon SVG paths
const svgIcons: Record<string, string> = {
  axes: 'M12 4v16m-8-8h16',
  angles: 'M12 3v6m0 0l3-3m-3 3L9 6m3 15a9 9 0 100-18',
  symmetry: 'M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15',
  pointGroups: 'M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z',
  gems: 'M12 3L2 8l10 14L22 8l-10-5zM2 8l10 4 10-4',
  default: 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z',
};

function getIconPath(name: string): string {
  const iconType = getIconForProperty(name);
  return svgIcons[iconType] || svgIcons.default;
}
---

<div class={`grid gap-4 ${variant === 'compact' ? 'sm:grid-cols-2 lg:grid-cols-3' : 'md:grid-cols-2'} my-6`}>
  {items.map(item => (
    <div class="group bg-gradient-to-br from-slate-50 to-slate-100/50 rounded-xl border border-slate-200 p-4 hover:border-slate-300 hover:shadow-sm transition-all">
      <div class="flex items-start gap-3">
        <!-- Icon -->
        <div class="w-9 h-9 rounded-lg bg-slate-200/70 flex items-center justify-center flex-shrink-0 group-hover:bg-slate-300/70 transition-colors">
          <svg class="w-5 h-5 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d={getIconPath(item.name)} />
          </svg>
        </div>

        <div class="flex-1 min-w-0">
          <!-- Header row -->
          <div class="flex items-start justify-between gap-2">
            <h4 class="font-semibold text-slate-900">{item.name}</h4>
            {item.value && !isCDL(item.value) && (
              <span class="text-sm font-mono bg-white text-slate-700 px-2 py-0.5 rounded border border-slate-200 whitespace-nowrap">
                {item.value}
              </span>
            )}
          </div>

          {/* Description */}
          {item.description && (
            <p class="text-sm text-slate-600 mt-1">{item.description}</p>
          )}

          {/* CDL value block */}
          {item.value && isCDL(item.value) && (
            <code class="block text-xs bg-slate-900 text-green-400 p-2 rounded mt-2 font-mono overflow-x-auto">
              {item.value}
            </code>
          )}

          {/* Example badges */}
          {item.examples && item.examples.length > 0 && (
            <div class="flex flex-wrap gap-1.5 mt-2">
              {item.examples.map(ex => (
                <Badge variant="crystal" size="sm">{ex}</Badge>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  ))}
</div>
