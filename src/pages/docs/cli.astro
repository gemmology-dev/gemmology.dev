---
import BaseLayout from '../../layouts/BaseLayout.astro';
import CodeBlock from '../../components/docs/CodeBlock.astro';
import { Breadcrumb } from '../../components/docs';
import { Container, Card } from '../../components/ui-astro';
---

<BaseLayout
  title="CLI Reference"
  description="Command-line interface reference for generating crystal visualizations."
>
  <Container size="md" padding="lg">
    <Breadcrumb items={[
      { label: 'Docs', href: '/docs' },
      { label: 'CLI Reference' }
    ]} />

    <article class="prose prose-slate max-w-none">
      <h1>Command Line Interface</h1>

      <p class="lead text-xl text-slate-600">
        Generate crystal visualizations directly from your terminal using the
        <code>gemmology</code> CLI tool.
      </p>

      <h2>Installation</h2>

      <CodeBlock lang="bash" code={`pip install gemmology-plugin`} />

      <p>This installs the <code>gemmology</code> command along with all required packages.</p>

      <h2>Basic Usage</h2>

      <CodeBlock lang="bash" code={`# Generate from CDL
gemmology --cdl "cubic[m3m]:{111}" -o octahedron.svg

# Use a preset
gemmology --preset diamond -o diamond.svg

# Generate twin
gemmology --twin japan -o japan_twin.svg`} />

      <h2>Options</h2>

      <h3>Input Options</h3>

      <table>
        <thead>
          <tr>
            <th>Option</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>--cdl &lt;expr&gt;</code></td>
            <td>CDL expression to render</td>
          </tr>
          <tr>
            <td><code>--preset &lt;name&gt;</code></td>
            <td>Use a mineral preset from the database</td>
          </tr>
          <tr>
            <td><code>--twin &lt;law&gt;</code></td>
            <td>Generate a twin using specified twin law</td>
          </tr>
          <tr>
            <td><code>--habit &lt;name&gt;</code></td>
            <td>Use a named crystal habit</td>
          </tr>
        </tbody>
      </table>

      <h3>Output Options</h3>

      <table>
        <thead>
          <tr>
            <th>Option</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>-o, --output &lt;file&gt;</code></td>
            <td>Output file path</td>
          </tr>
          <tr>
            <td><code>--format &lt;fmt&gt;</code></td>
            <td>Output format: <code>svg</code>, <code>stl</code>, <code>gltf</code>, <code>gemcad</code></td>
          </tr>
          <tr>
            <td><code>--size &lt;px&gt;</code></td>
            <td>SVG size in pixels (default: 400)</td>
          </tr>
        </tbody>
      </table>

      <h3>View Options</h3>

      <table>
        <thead>
          <tr>
            <th>Option</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>--elev &lt;deg&gt;</code></td>
            <td>Elevation angle in degrees (default: 30)</td>
          </tr>
          <tr>
            <td><code>--azim &lt;deg&gt;</code></td>
            <td>Azimuth angle in degrees (default: -45)</td>
          </tr>
          <tr>
            <td><code>--no-grid</code></td>
            <td>Disable grid background</td>
          </tr>
          <tr>
            <td><code>--no-axes</code></td>
            <td>Disable crystallographic axes</td>
          </tr>
        </tbody>
      </table>

      <h3>Info Panel Options</h3>

      <table>
        <thead>
          <tr>
            <th>Option</th>
            <th>Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>--info-fga</code></td>
            <td>Add FGA-style info panel with properties</td>
          </tr>
          <tr>
            <td><code>--info-basic</code></td>
            <td>Add basic info panel (name, system, CDL)</td>
          </tr>
        </tbody>
      </table>

      <h2>Examples</h2>

      <h3>Generate Diamond Preset</h3>
      <CodeBlock lang="bash" code={`gemmology --preset diamond -o diamond.svg`} />

      <h3>Custom CDL with View Angles</h3>
      <CodeBlock lang="bash" code={`gemmology --cdl "cubic[m3m]:{111}@1.0 + {100}@1.3" \\
  --elev 45 --azim -30 -o truncated.svg`} />

      <h3>Export to STL for 3D Printing</h3>
      <CodeBlock lang="bash" code={`gemmology --preset quartz --format stl -o quartz.stl`} />

      <h3>Generate with FGA Info Panel</h3>
      <CodeBlock lang="bash" code={`gemmology --preset ruby --info-fga --no-grid -o ruby.svg`} />

      <h3>Generate Japan Law Twin</h3>
      <CodeBlock lang="bash" code={`gemmology --twin japan --elev 20 --azim -60 -o japan_twin.svg`} />

      <h2>Available Presets</h2>

      <p>List all available presets:</p>
      <CodeBlock lang="bash" code={`gemmology --list-presets`} />

      <p>Get details about a specific preset:</p>
      <CodeBlock lang="bash" code={`gemmology --preset-info diamond`} />

      <h2>Available Twin Laws</h2>

      <p>List all available twin laws:</p>
      <CodeBlock lang="bash" code={`gemmology --list-twins`} />

      <div class="grid grid-cols-2 md:grid-cols-3 gap-2 not-prose my-8 text-sm">
        {[
          'spinel_law',
          'japan',
          'brazil',
          'dauphine',
          'carlsbad',
          'manebach',
          'baveno',
          'albite',
          'pericline',
          'iron_cross',
          'staurolite_60',
          'staurolite_90',
          'fluorite',
          'gypsum_swallow',
          'chrysoberyl',
          'rutile_geniculated'
        ].map((twin) => (
          <code class="bg-slate-100 px-2 py-1 rounded">{twin}</code>
        ))}
      </div>

      <h2>Programmatic Usage</h2>

      <p>The CLI is a thin wrapper around the Python packages. For programmatic use:</p>

      <CodeBlock lang="python" code={`from cdl_parser import parse_cdl
from crystal_geometry import cdl_to_geometry
from crystal_renderer import generate_svg
from mineral_database import get_preset

# From CDL
desc = parse_cdl("cubic[m3m]:{111}")
geom = cdl_to_geometry(desc)
svg = generate_svg(geom, elevation=30, azimuth=-45)

# From preset
preset = get_preset("diamond")
desc = parse_cdl(preset.cdl)
geom = cdl_to_geometry(desc)
svg = generate_svg(geom)`} />

      <Card padding="md" class="mt-12 bg-slate-50 border-slate-200">
        <h3 class="text-lg font-semibold text-slate-900 mt-0">Need help?</h3>
        <CodeBlock lang="bash" code={`gemmology --help`} />
      </Card>
    </article>
  </Container>
</BaseLayout>
